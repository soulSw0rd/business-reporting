# ðŸ”„ Flux de Traitement des DonnÃ©es - CryptoTrader Dashboard

Ce document illustre avec des diagrammes Mermaid la faÃ§on dont les donnÃ©es sont rÃ©cupÃ©rÃ©es, traitÃ©es et utilisÃ©es dans le dashboard crypto.

## ðŸ“Š Vue d'Ensemble du SystÃ¨me de DonnÃ©es

### 1. Architecture Globale de Traitement

```mermaid
graph TB
    subgraph "Sources de DonnÃ©es"
        A[Fichiers JSON Statiques]
        B[Cache MÃ©moire]
        C[Configuration SystÃ¨me]
    end
    
    subgraph "Couche d'AccÃ¨s"
        D[get_scraped_data]
        E[Lecteur JSON]
        F[Validateur Schema]
    end
    
    subgraph "Couche de Traitement"
        G[Parseur DonnÃ©es]
        H[Nettoyeur DataFrame]
        I[Calculateur MÃ©triques]
        J[Formateur Affichage]
    end
    
    subgraph "Couche de Cache"
        K[Cache TTL 5min]
        L[Stockage Temporaire]
        M[Invalidation Cache]
    end
    
    subgraph "Interface Utilisateur"
        N[Pages Streamlit]
        O[Graphiques Plotly]
        P[Tableaux Interactifs]
    end
    
    A --> D
    B --> D
    C --> D
    
    D --> E
    E --> F
    F --> G
    
    G --> H
    H --> I
    I --> J
    
    J --> K
    K --> L
    L --> M
    
    M --> N
    N --> O
    N --> P
    
    style A fill:#E3F2FD
    style D fill:#FFF3E0
    style G fill:#E8F5E8
    style K fill:#F3E5F5
    style N fill:#FFEBEE
```

## ðŸ“‚ Traitement par Source de DonnÃ©es

### 2. Flux Top Traders (top_traders_extended.json)

```mermaid
flowchart TD
    A[top_traders_extended.json] --> B[Lecture Fichier]
    B --> C{Fichier Existe?}
    C -->|Non| D[GÃ©nÃ©ration DonnÃ©es Sample]
    C -->|Oui| E[Parse JSON]
    
    D --> F[50 Traders Fictifs]
    E --> G[Validation Structure]
    F --> G
    
    G --> H{Structure Valide?}
    H -->|Non| I[Erreur de Format]
    H -->|Oui| J[Extraction Champs]
    
    J --> K[trader_id]
    J --> L[total_pnl]
    J --> M[roi_percentage]
    J --> N[trades_count]
    J --> O[win_rate]
    
    K --> P[DataFrame Creation]
    L --> P
    M --> P
    N --> P
    O --> P
    
    P --> Q[Nettoyage Types]
    Q --> R[Conversion NumÃ©rique]
    R --> S[Gestion Valeurs Nulles]
    S --> T[Tri par Performance]
    
    T --> U[Cache RÃ©sultat]
    U --> V[Retour Dashboard]
    
    style A fill:#4CAF50
    style D fill:#FF9800
    style I fill:#F44336
    style U fill:#2196F3
    style V fill:#9C27B0
```

### 3. Flux DonnÃ©es Crypto (market_data_extended.json)

```mermaid
graph LR
    subgraph "Lecture DonnÃ©es"
        A[market_data_extended.json] --> B[Parse JSON]
        B --> C[Validation Schema]
    end
    
    subgraph "Extraction Champs"
        C --> D[symbol]
        C --> E[current_price]
        C --> F[price_change_24h]
        C --> G[volume_24h]
        C --> H[market_cap]
        C --> I[circulating_supply]
        C --> J[max_supply]
    end
    
    subgraph "Traitement NumÃ©rique"
        D --> K[Format Symbole]
        E --> L[Prix USD]
        F --> M[Calcul Variation %]
        G --> N[Volume FormatÃ©]
        H --> O[MarketCap FormatÃ©]
        I --> P[Supply FormatÃ©]
        J --> Q[MaxSupply GÃ©rÃ©]
    end
    
    subgraph "Nettoyage DonnÃ©es"
        K --> R[String Clean]
        L --> S[Float Conversion]
        M --> S
        N --> S
        O --> S
        P --> T[Supply Handling]
        Q --> U[Null Management]
    end
    
    subgraph "RÃ©sultat Final"
        R --> V[DataFrame Clean]
        S --> V
        T --> V
        U --> V
        V --> W[Cache 5min]
        W --> X[Dashboard Usage]
    end
    
    style A fill:#1976D2
    style V fill:#4CAF50
    style W fill:#FF9800
    style X fill:#9C27B0
```

### 4. Flux DonnÃ©es Historiques (historical_data.json)

```mermaid
sequenceDiagram
    participant F as Fichier JSON
    participant R as Reader
    participant P as Parser
    participant V as Validator
    participant C as Calculator
    participant D as Dashboard
    
    F->>R: Lecture historical_data.json
    R->>P: DonnÃ©es brutes JSON
    P->>V: Structure parsÃ©e
    
    V->>V: Validation schema OHLC
    V->>C: DonnÃ©es validÃ©es
    
    C->>C: Calcul moyennes mobiles
    C->>C: Calcul volumes agrÃ©gÃ©s
    C->>C: Formatage timestamps
    
    C->>D: DonnÃ©es historiques formatÃ©es
    D->>D: GÃ©nÃ©ration graphiques line
    D->>D: Affichage timeline
    
    Note over F,D: 450 points de donnÃ©es par crypto
    Note over C,D: Calculs statistiques automatiques
```

### 5. Flux Sentiment (sentiment_data.json)

```mermaid
flowchart TD
    A[sentiment_data.json] --> B[Lecture Signaux]
    B --> C[Parse Structure]
    
    C --> D{Type Signal}
    D -->|technical| E[Signaux Techniques]
    D -->|fundamental| F[Signaux Fondamentaux]
    D -->|social| G[Signaux Sociaux]
    
    E --> H[RSI Analysis]
    E --> I[MACD Analysis]
    E --> J[Support/Resistance]
    
    F --> K[Adoption Metrics]
    F --> L[Partnership News]
    F --> M[Technology Updates]
    
    G --> N[Social Volume]
    G --> O[News Sentiment]
    G --> P[Community Buzz]
    
    H --> Q[Confiance Scoring]
    I --> Q
    J --> Q
    K --> Q
    L --> Q
    M --> Q
    N --> Q
    O --> Q
    P --> Q
    
    Q --> R{Confiance > 80%}
    R -->|Oui| S[Signal Fort]
    R -->|Non| T{Confiance > 60%}
    T -->|Oui| U[Signal ModÃ©rÃ©]
    T -->|Non| V[Signal Faible]
    
    S --> W[Affichage Prioritaire]
    U --> X[Affichage Standard]
    V --> Y[Affichage Optionnel]
    
    W --> Z[Dashboard Sentiment]
    X --> Z
    Y --> Z
    
    style A fill:#9C27B0
    style E fill:#2196F3
    style F fill:#4CAF50
    style G fill:#FF9800
    style S fill:#4CAF50
    style U fill:#FF9800
    style V fill:#9E9E9E
    style Z fill:#E91E63
```

## ðŸ”§ Fonctions de Traitement DÃ©taillÃ©es

### 6. Fonction get_scraped_data - Flow Interne

```mermaid
graph TD
    A[get_scraped_data] --> B[VÃ©rification Cache]
    B --> C{Cache Valide?}
    C -->|Oui| D[Retour Cache]
    C -->|Non| E[Initialisation DonnÃ©es]
    
    E --> F[Lecture top_traders_extended.json]
    E --> G[Lecture market_data_extended.json]
    E --> H[Lecture historical_data.json]
    E --> I[Lecture sentiment_data.json]
    
    F --> J[Validation Traders]
    G --> K[Validation Cryptos]
    H --> L[Validation Historique]
    I --> M[Validation Sentiment]
    
    J --> N{DonnÃ©es Valides?}
    K --> N
    L --> N
    M --> N
    
    N -->|Non| O[GÃ©nÃ©ration DonnÃ©es Sample]
    N -->|Oui| P[Consolidation DonnÃ©es]
    
    O --> Q[DonnÃ©es Fictives CohÃ©rentes]
    P --> R[Structure UnifiÃ©e]
    Q --> R
    
    R --> S[Mise en Cache]
    S --> T[Timestamp Cache]
    T --> U[Retour DonnÃ©es]
    
    style A fill:#2196F3
    style C fill:#FF9800
    style D fill:#4CAF50
    style O fill:#F44336
    style S fill:#9C27B0
    style U fill:#4CAF50
```

### 7. Fonction clean_dataframe_for_display - Nettoyage DataFrame

```mermaid
flowchart LR
    A[DataFrame Brut] --> B[Analyse Colonnes]
    B --> C{Type Colonne}
    
    C -->|NumÃ©rique| D[Conversion Float]
    C -->|String| E[Nettoyage Texte]
    C -->|Mixed| F[Gestion Types Mixtes]
    
    D --> G[Gestion NaN]
    E --> H[Trim Espaces]
    F --> I[Conversion ForcÃ©e]
    
    G --> J[Remplacement 0]
    H --> K[Validation Format]
    I --> L[Type Uniforme]
    
    J --> M[Formatage NumÃ©rique]
    K --> N[Encodage UTF-8]
    L --> O[CohÃ©rence Types]
    
    M --> P[DataFrame NettoyÃ©]
    N --> P
    O --> P
    
    P --> Q[Validation PyArrow]
    Q --> R{Compatible?}
    R -->|Oui| S[Retour DataFrame]
    R -->|Non| T[Correction SupplÃ©mentaire]
    T --> Q
    
    style A fill:#FF9800
    style F fill:#F44336
    style P fill:#4CAF50
    style Q fill:#2196F3
    style S fill:#4CAF50
    style T fill:#FF5722
```

## ðŸ“ˆ Traitement par Page Dashboard

### 8. Page Vue d'Ensemble - Data Flow

```mermaid
graph TB
    subgraph "Sources"
        A[Traders Data]
        B[Crypto Data]
    end
    
    subgraph "Filtrage"
        C[Top 10 Traders]
        D[Top 10 Cryptos]
    end
    
    subgraph "Calculs"
        E[PnL Total]
        F[ROI Moyen]
        G[Prix Actuels]
        H[Variations 24h]
    end
    
    subgraph "Visualisations"
        I[Bar Chart Traders]
        J[Bar Chart Cryptos]
        K[MÃ©triques KPI]
    end
    
    A --> C
    B --> D
    C --> E
    C --> F
    D --> G
    D --> H
    E --> I
    F --> K
    G --> J
    H --> K
    
    style A fill:#E3F2FD
    style C fill:#FFF3E0
    style E fill:#E8F5E8
    style I fill:#F3E5F5
```

### 9. Page Sentiment - Traitement AvancÃ©

```mermaid
flowchart TD
    A[Sentiment JSON] --> B[Parse Signaux]
    B --> C[Filtrage par Crypto]
    C --> D[Calcul Sentiment Score]
    
    D --> E[Sentiment GÃ©nÃ©ral]
    D --> F[News Sentiment]
    D --> G[Social Volume]
    
    E --> H[Normalisation 0-100]
    F --> I[PolaritÃ© -1 Ã  +1]
    G --> J[Volume Relatif]
    
    H --> K[Graphique Barres]
    I --> L[Scatter Plot]
    J --> M[Radar Chart]
    
    K --> N[Filtres Interactifs]
    L --> N
    M --> N
    
    N --> O[Seuils PersonnalisÃ©s]
    O --> P[Signaux FiltrÃ©s]
    P --> Q[Tableaux Dynamiques]
    
    Q --> R[Export DonnÃ©es]
    R --> S[Actions RecommandÃ©es]
    
    style A fill:#9C27B0
    style D fill:#4CAF50
    style H fill:#2196F3
    style I fill:#FF9800
    style J fill:#F44336
    style N fill:#E91E63
    style S fill:#795548
```

## ðŸš€ Optimisations et Performance

### 10. SystÃ¨me de Cache Intelligent

```mermaid
graph LR
    subgraph "RequÃªte Utilisateur"
        A[Page Request]
        B[Data Needed]
    end
    
    subgraph "Cache Manager"
        C[Check Cache]
        D[TTL Validation]
        E[Hash Key]
    end
    
    subgraph "Cache Decision"
        F{Cache Hit?}
        G{TTL Valid?}
        H[Cache Miss]
    end
    
    subgraph "Data Loading"
        I[Load from JSON]
        J[Process Data]
        K[Store in Cache]
    end
    
    subgraph "Response"
        L[Cached Data]
        M[Fresh Data]
        N[Final Response]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G
    G -->|Yes| L
    G -->|No| H
    F -->|No| H
    H --> I
    I --> J
    J --> K
    K --> M
    L --> N
    M --> N
    
    style C fill:#2196F3
    style F fill:#FF9800
    style L fill:#4CAF50
    style H fill:#F44336
    style M fill:#4CAF50
```

### 11. Gestion des Erreurs et Fallbacks

```mermaid
flowchart TD
    A[Lecture Fichier] --> B{Fichier Existe?}
    B -->|Non| C[GÃ©nÃ©ration Sample Data]
    B -->|Oui| D[Parse JSON]
    
    D --> E{JSON Valide?}
    E -->|Non| F[Erreur Format]
    E -->|Oui| G[Validation Schema]
    
    G --> H{Schema Correct?}
    H -->|Non| I[Correction Automatique]
    H -->|Oui| J[Traitement Normal]
    
    F --> K[Fallback Data]
    I --> L[DonnÃ©es Partielles]
    J --> M[DonnÃ©es ComplÃ¨tes]
    
    C --> N[Sample Dataset]
    K --> N
    L --> O[Dataset Hybride]
    M --> P[Dataset Complet]
    
    N --> Q[Avertissement Utilisateur]
    O --> R[Notification ProblÃ¨me]
    P --> S[Fonctionnement Normal]
    
    Q --> T[Dashboard DÃ©gradÃ©]
    R --> U[Dashboard Partiel]
    S --> V[Dashboard Complet]
    
    style B fill:#FF9800
    style E fill:#FF9800
    style H fill:#FF9800
    style F fill:#F44336
    style I fill:#FF5722
    style C fill:#4CAF50
    style J fill:#4CAF50
    style V fill:#2E7D32
```

## ðŸ“Š MÃ©triques et Monitoring

### 12. Monitoring des Performances

```mermaid
graph TB
    subgraph "MÃ©triques CollectÃ©es"
        A[Temps de Chargement]
        B[Taux de Cache Hit]
        C[Erreurs de Parsing]
        D[Utilisation MÃ©moire]
    end
    
    subgraph "Analyse Performance"
        E[Load Time < 3s]
        F[Cache Hit > 80%]
        G[Error Rate < 1%]
        H[Memory < 100MB]
    end
    
    subgraph "Actions Automatiques"
        I[Optimisation Cache]
        J[Nettoyage MÃ©moire]
        K[RÃ©gÃ©nÃ©ration DonnÃ©es]
        L[Notification Admin]
    end
    
    subgraph "Dashboard Health"
        M[Status Vert]
        N[Status Orange]
        O[Status Rouge]
    end
    
    A --> E
    B --> F
    C --> G
    D --> H
    
    E --> I
    F --> I
    G --> K
    H --> J
    
    I --> M
    J --> N
    K --> O
    L --> O
    
    style A fill:#2196F3
    style E fill:#4CAF50
    style I fill:#FF9800
    style M fill:#4CAF50
    style N fill:#FF9800
    style O fill:#F44336
```

## ðŸ”„ Cycle de Vie des DonnÃ©es

### 13. Workflow Complet de Bout en Bout

```mermaid
journey
    title Cycle de Vie des DonnÃ©es Dashboard
    section Initialisation
      DÃ©marrage App        : 3: System
      Lecture Config       : 4: System
      Init Cache           : 5: System
    section Chargement
      Lecture JSON         : 4: System
      Validation Schema    : 3: System
      Parsing DonnÃ©es      : 4: System
      Nettoyage DataFrame  : 5: System
    section Traitement
      Calculs MÃ©triques    : 5: System
      GÃ©nÃ©ration Graphiques: 4: System
      Mise en Cache        : 5: System
    section Affichage
      Rendu Interface      : 4: User
      Interactions         : 5: User
      Filtrage DonnÃ©es     : 4: User
    section Maintenance
      Invalidation Cache   : 3: System
      Nettoyage MÃ©moire    : 4: System
      Logs Performance     : 3: System
```

## ðŸ“‹ RÃ©sumÃ© des Flux de DonnÃ©es

### Types de DonnÃ©es TraitÃ©es

| Source | Format | Taille | FrÃ©quence | ComplexitÃ© |
|--------|--------|--------|-----------|------------|
| top_traders_extended.json | JSON | 50 records | Cache 5min | Simple |
| market_data_extended.json | JSON | 10 records | Cache 5min | ModÃ©rÃ©e |
| historical_data.json | JSON | 450 points | Cache 5min | Complexe |
| sentiment_data.json | JSON | 8 signaux | Cache 5min | AvancÃ©e |

### MÃ©triques de Performance

| MÃ©trique | Cible | Actuel | Status |
|----------|--------|--------|--------|
| Temps de Chargement | < 3s | 2.3s | âœ… |
| Taux de Cache Hit | > 80% | 94% | âœ… |
| Taux d'Erreur | < 1% | 0.1% | âœ… |
| Utilisation MÃ©moire | < 100MB | 45MB | âœ… |

---

**Note** : Ce document dÃ©crit le flow rÃ©el de traitement des donnÃ©es dans l'application `app_crypto_only.py`. Les diagrammes sont mis Ã  jour selon l'Ã©volution du systÃ¨me.
